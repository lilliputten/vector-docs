> $Id: local-dev-deployment.md 10476 2018-08-07 10:48:11Z miheev $
> $Date: 2018-08-07 13:48:11 +0300 (Вт, 07 авг 2018) $

Разворачивание проекта для разработки
=====================================

Требования к окружению
----------------------

На рабочей машине должно быть установлено ПО:

- Apache 2.4.
- Php (x86 VC 11) версии не ниже 5.4 для Apache.
- Phalcon версии не ниже 2.0.10 (библиотека в каталоге расширений php).
- Node.js версии не ниже 4.2.4.
- NGINX версии не ниже 1.9.7.
- СУБД Redis версии 2.8+ (+библиотека в каталоге расширений php).
- OpenSSL-Win64 1.0.x (если предполагается разработка на windows-машине).

См. раздел "Конфигурация локального сервера" в документе [Локальный сервер
разработчика](local-dev-server.md#Конфигурация-локального-сервера)

Порядок разворачивания
----------------------

Клонировать репозиторий `svn://185.41.41.90:8433/WEB_TINTS` (ip-адрес может
меняться, надо уточнять; см. [Адреса серверов и команды для запуска серверных
скриптов](dev-servers.md)). При настроенном алиасе или внутри сети --
`svn://svnsrv:8433/WEB_TINTS`.

В папке `WEB_TINTS/source` распаковать последние архивы с библиотеками и
nodejs-зависимостями из файлов (для windows-систем):

- `!ARC-YYMMDD-libs-vXX.zip`,
- `!ARC-YYMMDD-node_modules-vXX.zip`.

Библиотеки и зависимости можно устанавливать через `bower i` и `npm i` соотв.
При этом необходимо будет применять патчи. См. [Изменения в коде
библиотек](libs-patching.md)).

Запуск серера разработки ENB
----------------------------

bem/enb сервер запускается командами `npm run -s server` или `enb server` (если
установлен глобально).

При этом работа возможна только с демо-данными. См. [Эмуляция и накопление
данных от сервера приложения](fake-data.md).

Локальный сервер с подключением к серверу приложений
----------------------------------------------------

На машине внутри локальной сети, в которой установлен сервер приложений (напр.,
kupolbd -- см. конфигурацию шлюза "Купол",
`WEB_TINTS/release/core/scripts/nodejs/low_info_gas/KupolClient.ini`) возможен
запуск сервера, работающего с реальными данными:

- С помощью обычного web-сервера (Apache или любого другого с настроенным php),
  нацеленного на папку `WEB_TINTS/release`, можно получить точную копию
  рабочего окружения.
- Специальным образом настроенный nginx может перенаправлять часть запросов к
  работающему локально bem/enb серверу для генерации контента (js-код, стили,
  описания страниц) "на лету".

Для этого должен быть запущен шлюз сервера приложений -- в папке
`WEB_TINTS/release/core/scripts/nodejs/low_info_gas` запускается:

- `node index.js`
- или `node index.js --debug` -- в отладочном режиме (на 2018.08.01 -- влияет
  на установку отладочных задержек при запросе данных через сокеты).

Установка/запуск локального сервера приложений
----------------------------------------------

Для того, чтобы получить полноценный рабочий сервер, необходимо будет прокинуть
канал доступа от шлюза к серверу приложений.

