> $Id: libs-patching.md 10419 2018-07-31 13:46:42Z miheev $
> $Date: 2018-07-31 16:46:42 +0300 (Вт, 31 июл 2018) $

Изменения в коде библиотек
==========================

Если возникает необходимость править библиотечные файлы, то правки производятся
в установленных в стандартное место библиотечных модулях, в папке
`WEB_TINTS/source/libs/` или node-пакетах в папке
`WEB_TINTS/source/node_modules`.

Лучше этого не делать, но если уж пришлось, то при этом желательно:

- Детально описать, что и зачем делается, с какой версией библиотеки.

- Сделать diff и/или сохранить копии оригинальных и изменяемых файлов, -- чтобы
  впоследствии можно было повторить процедуру с новой версией или хотя бы
  понять, что именно и зачем менялось.

Все описания, патчи и сохранённые (оригинальные и модифицированные) файлы
следует сохранять в папке `WEB_TINTS/source/!Patches/`, желательно в подпапку с
указанием текущей версии библиотеки.

В той же папке см. shell-утилиты для работы с патчами:

- `patch-tool-list-all`: Показать все `pacth-config.sh` (поиск по всем вложенным папкам).
- `patch-tool-apply-all`: Применить все `pacth-config.sh` (поиск по всем вложенным папкам).
- `patch-tool-apply`: Применить патч для `pacth-config.sh` из текущей папки.

Утилиты работают со всеми патчами, которые описываются файлами
`patch-config.sh`, в которых должны быть определны три переменные:

- `ROOTCD`: Root path for looking up in folders tree.
- `PATCHCD`: Path relative to ROOT -- working path.
- `POSTCMD`: Command to run after all patches applied.

Для примера см. патч библиотеки `nicescroll`: `WEB_TINTS/source/!Patches/jquery.nicescroll/3.7.6/patch-config.sh`.

Прочие патчи надо применять в ручном режиме (обычно создаётся скрипт `patch.sh` в папке с патчем).

